---
import type { CollectionEntry } from 'astro:content';
import { BASE_URL } from '../consts';

interface Props {
	post: CollectionEntry<'tech'> | CollectionEntry<'life'>;
}

const { post } = Astro.props;

const formattedDate = post.data.pubDate.toLocaleDateString('en-us', {
	year: 'numeric',
	month: 'short',
	day: 'numeric',
});

const isEnglish = post.slug.startsWith('en/');
const slugClean = post.slug.replace(/^(ko|en)\//, '');
const postUrl = isEnglish 
    ? `${BASE_URL}/en/${post.collection}/${slugClean}/` 
    : `${BASE_URL}/${post.collection}/${slugClean}/`;
---

<article class="flex flex-col h-full overflow-hidden rounded-md shadow-sm transition-all hover:-translate-y-1 hover:shadow-lg border" style="background-color: var(--bg-card); border-color: var(--border-main)">
	<a href={postUrl} class="block h-52 w-full overflow-hidden" style="background-color: var(--bg-hover)">
        {post.data.heroImage ? (
            <img src={post.data.heroImage} alt="" class="h-full w-full object-cover transition-transform duration-300 hover:scale-105" />
        ) : (
            <div class="flex h-full w-full items-center justify-center" style="color: var(--text-muted)">
                <span class="text-5xl opacity-50">üìù</span>
            </div>
        )}
    </a>
    <div class="flex flex-1 flex-col p-5">
        <a href={postUrl}>
		    <h2 class="mb-3 text-lg font-bold line-clamp-2 leading-tight" style="color: var(--text-main)">
			    {post.data.title}
		    </h2>
        </a>
		<p class="mb-4 flex-1 text-sm text-gray-600 line-clamp-3 dark:text-gray-400 leading-relaxed">
			{post.data.description}
		</p>
		<div class="mt-auto flex items-center justify-between text-xs text-gray-500 dark:text-gray-400">
			<time datetime={post.data.pubDate.toISOString()}>
				{formattedDate}
			</time>
             {post.data.tags && post.data.tags.length > 0 && (
                <div class="flex gap-1">
                    {post.data.tags.slice(0, 2).map(tag => (
                        <span class="bg-gray-100 dark:bg-gray-700 px-1.5 py-0.5 rounded text-gray-600 dark:text-gray-300">#{tag}</span>
                    ))}
                    {post.data.tags.length > 2 && <span>+{post.data.tags.length - 2}</span>}
                </div>
            )}
		</div>
	</div>
</article>
